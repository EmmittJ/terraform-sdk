resource "aws_security_group" "example" {

  dynamic "egress" {
    for_each = var.egress_rules
    iterator = rule
    content {
      from_port = rule.value.from_port
      to_port = rule.value.to_port
      protocol = rule.value.protocol
      cidr_blocks = rule.value.cidr_blocks
    }
  }  name = "example-sg"
}
